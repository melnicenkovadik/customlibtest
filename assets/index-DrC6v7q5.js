import{r as i}from"./index-CTjT7uj6.js";import{c as y}from"./index-DV6JdDQx.js";import{P as m,d as _}from"./index-9_93ZtqA.js";import{u as T}from"./index-Dt9fs78b.js";import{a as b,u as U}from"./index-okHkxgFN.js";import{j as P}from"./jsx-runtime-Cw0GR0a5.js";import{E as j}from"./index-BbmHap-z.js";function M(r,e=globalThis==null?void 0:globalThis.document){const s=b(r);i.useEffect(()=>{const n=t=>{t.key==="Escape"&&s(t)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[s,e])}var z="DismissableLayer",h="dismissableLayer.update",H="dismissableLayer.pointerDownOutside",K="dismissableLayer.focusOutside",R,x=i.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),X=i.forwardRef((r,e)=>{const{disableOutsidePointerEvents:s=!1,onEscapeKeyDown:n,onPointerDownOutside:t,onFocusOutside:o,onInteractOutside:l,onDismiss:u,...E}=r,c=i.useContext(x),[d,S]=i.useState(null),f=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,A]=i.useState({}),N=T(e,a=>S(a)),L=Array.from(c.layers),[F]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),W=L.indexOf(F),D=d?L.indexOf(d):-1,k=c.layersWithOutsidePointerEventsDisabled.size>0,C=D>=W,I=G(a=>{const v=a.target,g=[...c.branches].some(p=>p.contains(v));!C||g||(t==null||t(a),l==null||l(a),a.defaultPrevented||u==null||u())},f),O=J(a=>{const v=a.target;[...c.branches].some(p=>p.contains(v))||(o==null||o(a),l==null||l(a),a.defaultPrevented||u==null||u())},f);return M(a=>{D===c.layers.size-1&&(n==null||n(a),!a.defaultPrevented&&u&&(a.preventDefault(),u()))},f),i.useEffect(()=>{if(d)return s&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(R=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(d)),c.layers.add(d),w(),()=>{s&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=R)}},[d,f,s,c]),i.useEffect(()=>()=>{d&&(c.layers.delete(d),c.layersWithOutsidePointerEventsDisabled.delete(d),w())},[d,c]),i.useEffect(()=>{const a=()=>A({});return document.addEventListener(h,a),()=>document.removeEventListener(h,a)},[]),P.jsx(m.div,{...E,ref:N,style:{pointerEvents:k?C?"auto":"none":void 0,...r.style},onFocusCapture:y(r.onFocusCapture,O.onFocusCapture),onBlurCapture:y(r.onBlurCapture,O.onBlurCapture),onPointerDownCapture:y(r.onPointerDownCapture,I.onPointerDownCapture)})});X.displayName=z;var Y="DismissableLayerBranch",q=i.forwardRef((r,e)=>{const s=i.useContext(x),n=i.useRef(null),t=T(e,n);return i.useEffect(()=>{const o=n.current;if(o)return s.branches.add(o),()=>{s.branches.delete(o)}},[s.branches]),P.jsx(m.div,{...r,ref:t})});q.displayName=Y;function G(r,e=globalThis==null?void 0:globalThis.document){const s=b(r),n=i.useRef(!1),t=i.useRef(()=>{});return i.useEffect(()=>{const o=u=>{if(u.target&&!n.current){let E=function(){B(H,s,c,{discrete:!0})};const c={originalEvent:u};u.pointerType==="touch"?(e.removeEventListener("click",t.current),t.current=E,e.addEventListener("click",t.current,{once:!0})):E()}else e.removeEventListener("click",t.current);n.current=!1},l=window.setTimeout(()=>{e.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(l),e.removeEventListener("pointerdown",o),e.removeEventListener("click",t.current)}},[e,s]),{onPointerDownCapture:()=>n.current=!0}}function J(r,e=globalThis==null?void 0:globalThis.document){const s=b(r),n=i.useRef(!1);return i.useEffect(()=>{const t=o=>{o.target&&!n.current&&B(K,s,{originalEvent:o},{discrete:!1})};return e.addEventListener("focusin",t),()=>e.removeEventListener("focusin",t)},[e,s]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function w(){const r=new CustomEvent(h);document.dispatchEvent(r)}function B(r,e,s,{discrete:n}){const t=s.originalEvent.target,o=new CustomEvent(r,{bubbles:!1,cancelable:!0,detail:s});e&&t.addEventListener(r,e,{once:!0}),n?_(t,o):t.dispatchEvent(o)}var Q="Portal",V=i.forwardRef((r,e)=>{var u;const{container:s,...n}=r,[t,o]=i.useState(!1);U(()=>o(!0),[]);const l=s||t&&((u=globalThis==null?void 0:globalThis.document)==null?void 0:u.body);return l?j.createPortal(P.jsx(m.div,{...n,ref:e}),l):null});V.displayName=Q;export{X as D,V as P};
